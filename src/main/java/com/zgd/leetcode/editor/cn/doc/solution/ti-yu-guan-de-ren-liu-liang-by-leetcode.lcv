#### 方法：使用 `JOIN` 和 `WHERE` 子句【通过】

**思路**

在表 `stadium` 中查询人流量超过 100 的记录，将查询结果与其自身的临时表连接，再使用 `WHERE` 子句获得满足条件的记录。

**算法**

第一步：查询人流量超过 100 的记录，然后将结果与其自身的临时表连接。

* [snippet1-MySQL]

```mysql
select distinct t1.*
from stadium t1, stadium t2, stadium t3
where t1.people >= 100 and t2.people >= 100 and t3.people >= 100
;
```

* 

```
| id | date       | people | id | date       | people | id | date       | people |
|----|------------|--------|----|------------|--------|----|------------|--------|
| 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    |
| 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    |
| 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    |
| 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    |
| 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    |
| 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    |
| 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    |
| 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    |
| 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    |
| 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    |
| 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    |
| 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    |
| 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    |
| 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    |
| 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    |
| 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    |
| 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    |
| 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    |
| 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    |
| 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    |
| 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    |
| 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    |
| 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    |
| 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    |
| 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    |
| 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    |
| 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    |
| 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    |
| 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    |
| 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    |
| 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    |
| 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    |
| 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    |
| 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    |
| 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    |
| 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    |
| 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    |
| 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    |
| 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    |
| 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    |
| 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    |
| 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    |
| 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    |
| 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    |
| 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    |
| 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    |
| 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    |
| 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    |
| 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    |
| 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    |
| 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    |
| 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    |
| 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    |
| 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    |
| 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    |
| 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    |
| 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    |
| 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    |
| 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    |
| 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    |
| 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    |
| 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    |
| 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    |
| 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    |
| 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    |
| 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    |
| 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    |
| 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    |
| 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    |
| 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    |
| 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    |
| 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    |
| 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    |
| 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    |
| 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    |
| 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    |
| 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    |
| 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    |
| 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    |
| 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    |
| 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    |
| 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    |
| 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    |
| 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    |
| 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    |
| 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    |
| 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    |
| 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    |
| 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    |
| 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    |
| 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    |
| 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    |
| 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    |
| 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    |
| 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    |
| 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    |
| 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    |
| 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    |
| 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    |
| 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    |
| 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    |
| 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    |
| 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    |
| 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    |
| 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    |
| 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    |
| 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    |
| 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    |
| 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   |
| 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   |
| 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   |
| 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   |
| 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   |
| 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   |
| 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   |
| 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   |
| 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   |
| 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   |
| 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   |
| 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   |
| 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   |
| 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   |
| 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   |
| 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   |
| 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   |
| 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   |
| 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   |
| 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   |
| 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   |
| 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   |
| 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   |
| 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   |
| 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   |
| 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   |
| 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   |
| 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   |
| 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   |
| 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   |
| 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   |
| 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   |
| 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   |
| 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   |
| 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   |
| 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   |
| 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    |
| 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    |
| 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    |
| 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    |
| 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    |
| 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    |
| 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    |
| 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    |
| 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    |
| 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    |
| 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    |
| 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    |
| 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    |
| 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    |
| 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    |
| 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    |
| 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    |
| 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    |
| 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    |
| 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    |
| 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    |
| 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    |
| 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    |
| 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    |
| 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    |
| 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    |
| 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    |
| 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    |
| 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    |
| 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    |
| 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    |
| 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    |
| 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    |
| 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    |
| 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    |
| 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    |
| 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    |
| 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    |
| 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    |
| 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    |
| 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    |
| 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    |
| 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    |
| 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    |
| 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    |
| 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    |
| 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    |
| 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    |
| 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    |
| 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    |
| 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    |
| 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    |
| 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    |
| 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    |
| 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    |
| 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    |
| 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    |
| 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    |
| 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    |
| 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    |
| 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    |
| 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    |
| 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    |
| 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    |
| 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    |
| 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    |
| 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    |
| 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    |
| 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    |
| 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    |
| 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    |
| 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    |
```

> - 共有 6 天人流量超过 100 人，[笛卡尔积](https://baike.baidu.com/item/%E7%AC%9B%E5%8D%A1%E5%B0%94%E4%B9%98%E7%A7%AF/6323173?fromtitle=%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF&fromid=1434391&fr=aladdin) 后有 216（6*6*6） 条记录。
> - 前 3 列来自表 t1，中间 3 列来自表 t2，最后 3 列来自表 t3。

表 t1，t2 和 t3 相同，需要考虑添加哪些条件能够得到想要的结果。以 t1 为例，它有可能是高峰期的第 1 天，第 2 天，或第 3 天。

- t1 是高峰期第 1 天：`(t1.id - t2.id = 1 and t1.id - t3.id = 2 and t2.id - t3.id =1)  -- t1, t2, t3`
- t1 是高峰期第 2 天：`(t2.id - t1.id = 1 and t2.id - t3.id = 2 and t1.id - t3.id =1) -- t2, t1, t3`
- t1 是高峰期第 3 天：`(t3.id - t2.id = 1 and t2.id - t1.id =1 and t3.id - t1.id = 2) -- t3, t2, t1`

* [snippet2-MySQL]

```mysql
select t1.*
from stadium t1, stadium t2, stadium t3
where t1.people >= 100 and t2.people >= 100 and t3.people >= 100
and
(
	  (t1.id - t2.id = 1 and t1.id - t3.id = 2 and t2.id - t3.id =1)  -- t1, t2, t3
    or
    (t2.id - t1.id = 1 and t2.id - t3.id = 2 and t1.id - t3.id =1) -- t2, t1, t3
    or
    (t3.id - t2.id = 1 and t2.id - t1.id =1 and t3.id - t1.id = 2) -- t3, t2, t1
)
;
```

* 

```
| id | date       | people |
|----|------------|--------|
| 7  | 2017-01-07 | 199    |
| 6  | 2017-01-06 | 1455   |
| 8  | 2017-01-08 | 188    |
| 7  | 2017-01-07 | 199    |
| 5  | 2017-01-05 | 145    |
| 6  | 2017-01-06 | 1455   |
```

可以看到查询结果中存在重复的记录，再使用 `DISTINCT` 去重。

**MySQL**

* [solution1-MySQL]

```mysql
select distinct t1.*
from stadium t1, stadium t2, stadium t3
where t1.people >= 100 and t2.people >= 100 and t3.people >= 100
and
(
	  (t1.id - t2.id = 1 and t1.id - t3.id = 2 and t2.id - t3.id =1)  -- t1, t2, t3
    or
    (t2.id - t1.id = 1 and t2.id - t3.id = 2 and t1.id - t3.id =1) -- t2, t1, t3
    or
    (t3.id - t2.id = 1 and t2.id - t1.id =1 and t3.id - t1.id = 2) -- t3, t2, t1
)
order by t1.id
;
```

