//ç»™ä½ ä¸€ä¸ªå¥‡æ€ªçš„æ‰“å°æœºï¼Œå®ƒæœ‰å¦‚ä¸‹ä¸¤ä¸ªç‰¹æ®Šçš„æ‰“å°è§„åˆ™ï¼š 
//
// 
// æ¯ä¸€æ¬¡æ“ä½œæ—¶ï¼Œæ‰“å°æœºä¼šç”¨åŒä¸€ç§é¢œè‰²æ‰“å°ä¸€ä¸ªçŸ©å½¢çš„å½¢çŠ¶ï¼Œæ¯æ¬¡æ‰“å°ä¼šè¦†ç›–çŸ©å½¢å¯¹åº”æ ¼å­é‡ŒåŸæœ¬çš„é¢œè‰²ã€‚ 
// ä¸€æ—¦çŸ©å½¢æ ¹æ®ä¸Šé¢çš„è§„åˆ™ä½¿ç”¨äº†ä¸€ç§é¢œè‰²ï¼Œé‚£ä¹ˆ ç›¸åŒçš„é¢œè‰²ä¸èƒ½å†è¢«ä½¿ç”¨ ã€‚ 
// 
//
// ç»™ä½ ä¸€ä¸ªåˆå§‹æ²¡æœ‰é¢œè‰²çš„ m x n çš„çŸ©å½¢ targetGrid ï¼Œå…¶ä¸­ targetGrid[row][col] æ˜¯ä½ç½® (row, col) çš„é¢œè‰²ã€‚
// 
//
// å¦‚æœä½ èƒ½æŒ‰ç…§ä¸Šè¿°è§„åˆ™æ‰“å°å‡ºçŸ©å½¢ targetGrid ï¼Œè¯·ä½ è¿”å› true ï¼Œå¦åˆ™è¿”å› false ã€‚ 
//
// 
//
// ç¤ºä¾‹ 1ï¼š 
//  1 1 1 1
//  1 2 2 1
//  1 2 2 1
//  1 1 1 1
//
// è¾“å…¥ï¼štargetGrid = [[1,1,1,1],[1,2,2,1],[1,2,2,1],[1,1,1,1]]
//è¾“å‡ºï¼štrue
// 
//
// ç¤ºä¾‹ 2ï¼š  1: (0,3) (0,3). 3:(1,2)(2,3) 4:(2,3) (3,3) 5(3,3)(0,1)
// 1 1 1 1
// 1 1 3 3
// 1 1 3 4
// 5 5 1 4
// è¾“å…¥ï¼štargetGrid = [[1,1,1,1],[1,1,3,3],[1,1,3,4],[5,5,1,4]]
//è¾“å‡ºï¼štrue
// 1 2 1
// 2 1 2
// 1 2 1
// ç¤ºä¾‹ 3ï¼š 
//
// è¾“å…¥ï¼štargetGrid = [[1,2,1],[2,1,2],[1,2,1]]
//è¾“å‡ºï¼šfalse
//è§£é‡Šï¼šæ²¡æœ‰åŠæ³•å¾—åˆ° targetGrid ï¼Œå› ä¸ºæ¯ä¸€è½®æ“ä½œä½¿ç”¨çš„é¢œè‰²äº’ä¸ç›¸åŒã€‚ 
//
// ç¤ºä¾‹ 4ï¼š
// 1 1 1
// 3 1 3
// è¾“å…¥ï¼štargetGrid = [[1,1,1],[3,1,3]]
//è¾“å‡ºï¼šfalse
// 
//
// 
//
// æç¤ºï¼š 
//
// 
// m == targetGrid.length 
// n == targetGrid[i].length 
// 1 <= m, n <= 60 
// 1 <= targetGrid[row][col] <= 60 
// 
//
// Related Topics å›¾ æ‹“æ‰‘æ’åº æ•°ç»„ çŸ©é˜µ ğŸ‘ 39 ğŸ‘ 0


  
package com.zgd.leetcode.editor.cn;

import java.util.*;

public class StrangePrinterIi{

  /**
  * 1591
  * å¥‡æ€ªçš„æ‰“å°æœº II
  * 
  * 
  *
  * 2022-11-10 15:14:26
  */  
  public static void main(String[] args) {
    Solution solution = new StrangePrinterIi().new Solution();
    solution.isPrintable(new int[][]{{1,1,1,1},{1,2,2,1},{1,2,2,1},{1,1,1,1}});
    //  1 1 1 1
  //    1 2 2 1
     // 1 2 2 1
     // 1 1 1 1
  }
  
  //leetcode submit region begin(Prohibit modification and deletion)
class Solution {

      /**
       * æ€è·¯, å’Œä¸€å¼€å§‹é”™è¯¯çš„æ€è·¯æ–¹æ³•ä¸ä¸€æ ·
       * è¿™æ¬¡çš„æ€è·¯æ˜¯ä»ä¸Šå¾€ä¸‹,æ¶ˆé™¤. æŠŠä¸€ä¸ªé¢œè‰²åŒºåŸŸé‡Œæ²¡æœ‰å…¶ä»–é¢œè‰²,æˆ–è€…åŒ…å«äº†ç™½è‰²åŒºåŸŸçš„, æ¶‚ç™½. æœ€åçœ‹çœ‹æ˜¯ä¸æ˜¯éƒ½æ¶‚ç™½äº†.
       * å³æ‰¾å‡ºå„ä¸ªé¢œè‰²è¾¹ç•Œ, ç„¶ååˆ¤æ–­è¾¹ç•Œé‡Œæ˜¯å¦éƒ½æ˜¯è¿™ä¸ªé¢œè‰²æˆ–0, å¦‚æœæ˜¯,åŒºåŸŸé‡Œæ”¹ä¸º0.ä»¥æ­¤ç±»æ¨
       *
       * å…·ä½“æ”¾åˆ°ä»£ç é‡Œ,æŠŠé¢œè‰²,å’Œå¯¹åº”çš„åŒºåŸŸæ”¾åˆ°mapé‡Œ.åœ¨ä¸€ä¸ªæ­»å¾ªç¯ä¸­,ä¸€ç›´åˆ¤æ–­è¿™ä¸ªåŒºåŸŸæ˜¯å¦æ»¡è¶³æ¡ä»¶,æ»¡è¶³åˆ™æ¶‚è‰²,ç„¶åä»mapé‡Œç§»é™¤è¿™ä¸ªé¢œè‰².
       * æœ€åçœ‹çœ‹,å¦‚æœmapæ˜¯emptyäº†,è¿”å›true. å¦‚æœè¿™ä¸€è½®å¾ªç¯æ²¡æœ‰ä»»ä½•é¢œè‰²è¢«æ¶‚ç™½,è¿”å›false
       *
       * è§£ç­”æˆåŠŸ:
       * 	æ‰§è¡Œè€—æ—¶:9 ms,å‡»è´¥äº†80.28% çš„Javaç”¨æˆ·
       * 	å†…å­˜æ¶ˆè€—:41.8 MB,å‡»è´¥äº†42.25% çš„Javaç”¨æˆ·
       */
      public boolean isPrintable(int[][] targetGrid){
          Map<Integer,int[]> yanses = new HashMap<>();
          //yanses[0] ä¸­0è¡¨ç¤ºé¢œè‰²,1,2è¡¨ç¤ºæœ€å°å’Œæœ€å¤§æ¨ªåæ ‡,3,4è¡¨ç¤ºæœ€å°å’Œæœ€å¤§çºµåæ ‡
          int y = targetGrid.length;
          int x = targetGrid[0].length;
          for (int i = 0; i < y; i++) { //çºµåæ ‡
              for (int j = 0; j < x; j++) { //æ¨ªåæ ‡
                  //éå†,è®°å½•æ¯ä¸ªé¢œè‰²åŒºåŸŸçš„æœ€å¤§,æœ€å°åæ ‡,ä»¥æ­¤æ¡†å®šåŒºåŸŸ
                  int ys = targetGrid[i][j];
                  int[] quyu =yanses.get(ys);
                  if (quyu == null){
                      quyu = new int[5];
                      quyu[0] = ys;
                      quyu[1] = quyu[2] = j;
                      quyu[3] = quyu[4] = i;
                  }
                  quyu[1] = Math.min(quyu[1],j); //æ¨ªåæ ‡
                  quyu[2] = Math.max(quyu[2],j);
                  quyu[3] = Math.min(quyu[3],i); //çºµåæ ‡
                  quyu[4] = Math.max(quyu[4],i);
                  yanses.put(ys,quyu);
              }
          }
          /*è¿™é‡Œæ˜¯ä¸€ä¸ªå‘,ç›´æ¥ç”¨mapçš„remove,ä¼šå› ä¸ºè¾¹éå†è¾¹ä¿®æ”¹æŠ¥å¹¶å‘ä¿®æ”¹å¼‚å¸¸, åŒæ—¶å¦‚æœç›´æ¥ç”¨keysetä¹Ÿæ˜¯,å› ä¸ºè¿”å›çš„æ˜¯keysçš„è§†å›¾,ä¿®æ”¹setä¹Ÿä¼šç›´æ¥ä¿®æ”¹map*/
          Set<Integer> keys = new HashSet<>(yanses.keySet());
          while(!keys.isEmpty()){
              int size = keys.size();
              //åˆ¤æ–­æ¯ä¸ªé¢œè‰²åŒºåŸŸé‡Œ,æ˜¯å¦éƒ½æ˜¯è‡ªèº«é¢œè‰²æˆ–ç™½è‰²
              out:for (int[] yanse : yanses.values()) {
                  for (int i = yanse[1]; i <= yanse[2] ; i++) { //æ¨ªåæ ‡
                      for (int j = yanse[3]; j <= yanse[4]; j++) { //çºµåæ ‡
                          if (targetGrid[j][i] != 0 &&
                                  targetGrid[j][i] != yanse[0]) {
                              //å³æ—¢æ˜¯ç™½è‰²,ä¹Ÿä¸æ˜¯è‡ªèº«é¢œè‰²,è·³è¿‡
                              continue out;
                          }
                      }
                  }
                  //è¾¹ç•Œå†…æ˜¯æ—¢æ˜¯ç™½è‰²,æˆ–è‡ªèº«é¢œè‰²,æ¶‚ç™½
                  for (int i = yanse[1]; i <= yanse[2] ; i++) { //æ¨ªåæ ‡
                      for (int j = yanse[3]; j <= yanse[4]; j++) { //çºµåæ ‡
                          targetGrid[j][i] = 0;
                      }
                  }
                  keys.remove(yanse[0]);
              }
              if (keys.size() == size){
                  //sizeæ²¡å˜,è¯´æ˜æ²¡æ»¡è¶³æ¡ä»¶çš„
                  return false;
              }
          }
        return true;
      }
  }
//leetcode submit region end(Prohibit modification and deletion)

    /**
     * è¿™ä¸ªæ€è·¯å¤±è´¥äº†.
     * ç®€å•æ¥è¯´, æ˜¯æŠŠè¿™ä¸ªä¸€ä¸ªä¸ªç›¸äº’å åŠ çš„é¢œè‰²å—å½“æˆä¸€æ¡æ¡ç­‰é«˜çº¿. ç„¶åä»ä¸‹å¾€ä¸ŠæŠŠé¢œè‰²æ’åº. å†ä»ä¸‹å¾€ä¸Šåœ¨ä¸€ä¸ªç­‰å¤§çš„åŒºåŸŸæ¶‚è‰²,çœ‹çœ‹æœ€åç»“æœæ˜¯å¦ä¸€æ ·.
     * ç»“æœæ˜¯åœ¨ç»™å‡ºçš„å‡ ä¸ªä¾‹å­ä¸­, è¿˜æ˜¯è§£ç­”æˆåŠŸçš„. ä½†æ˜¯åœ¨æµ‹è¯•ç”¨ä¾‹48*48çš„æ ¼å­å¤±è´¥äº†.è¯´æ˜è¿™ä¸ªæ€è·¯ä¸ä¸¥è°¨
     * @param targetGrid
     * @return
     */
    public boolean isPrintable(int[][] targetGrid) {
        //æ€è·¯: é¦–å…ˆé¢˜ç›®å¾ˆå¥½ç†è§£,ä½†æ˜¯æ€ä¹ˆåˆ¤æ–­ç»“æœæ˜¯å¦ä¸ºtrueå‘¢?
        // 1.è½¬ä¸ºç­‰é«˜çº¿åœ°å›¾æ¥çœ‹,æˆ‘ä»¬æŠŠæ¯ä¸ªé¢œè‰²å¯¹åº”çš„æœ€å¤§çŸ©å½¢åŒºåŸŸè®¡ç®—å‡ºæ¥
        // 2.æˆ‘ä»¬å¯¹åŒºåŸŸé«˜åº¦è¿›è¡Œæ’åº. å¦‚æœAåŒ…è£¹B,B>A,å¦‚æœAå’ŒBæœ‰äº¤é›†,åˆ¤æ–­äº¤é›†æ˜¯Aé¢œè‰²è¿˜æ˜¯Bé¢œè‰²,å¦‚æœæ˜¯A,åˆ™A>B. å¦‚æœAå’ŒBä¸ç›¸äº¤,ä¸¤è€…ç›¸ç­‰
        // 3. ç„¶åæˆ‘ä»¬æ ¹æ®æ’å¥½åº,å¯¹çŸ©é˜µéå†,å¡«å……
        // 4. å°†å¡«å……åçš„å›¾å’ŒåŸå›¾æ¯”è¾ƒ
        Map<Integer,int[]> yanses = new HashMap<>();
        //yanses[0] ä¸­0è¡¨ç¤ºé¢œè‰²,1,2è¡¨ç¤ºæœ€å°å’Œæœ€å¤§æ¨ªåæ ‡,3,4è¡¨ç¤ºæœ€å°å’Œæœ€å¤§çºµåæ ‡
        int y = targetGrid.length;
        int x = targetGrid[0].length;
        for (int i = 0; i < y; i++) {
            for (int j = 0; j < x; j++) {
                //éå†,è®°å½•æ¯ä¸ªé¢œè‰²åŒºåŸŸçš„æœ€å¤§,æœ€å°åæ ‡,ä»¥æ­¤æ¡†å®šåŒºåŸŸ
                int ys = targetGrid[i][j];
                int[] quyu =yanses.get(ys);
                if (quyu == null){
                    quyu = new int[5];
                    quyu[0] = ys;
                    quyu[1] = quyu[2] = j;
                    quyu[3] = quyu[4] = i;
                }
                quyu[1] = Math.min(quyu[1],j);
                quyu[2] = Math.max(quyu[2],j);
                quyu[3] = Math.min(quyu[3],i);
                quyu[4] = Math.max(quyu[4],i);
                yanses.put(ys,quyu);
            }
        }
        //æ’é™¤æ²¡æœ‰é¢œè‰²çš„,æ”¾åˆ°listæ’åº
        List<int[]> yanselist = new ArrayList<>();
        for (int[] yans : yanses.values()) {
            if(yans != null){
                yanselist.add(yans);
            }
        }
        yanselist.sort((a,b) -> {
            //å¤å†™æ’åºè§„åˆ™,
            if (a[1] <= b[1]
                    && a[2] >= b[2]
                    && a[3] <= b[3]
                    && a[4] >= b[4]
            ){
                //æ­¤ä¸ºaåŒºåŸŸåŒ…æ‹¬äº†båŒºåŸŸ,æŒ‰ç­‰é«˜çº¿ç†è§£,b>a
                return  -1;
            }else if (b[1] <= a[1]
                    && b[2] >= a[2]
                    && b[3] <= a[3]
                    && b[4] >= a[4]
            ){
                //æ­¤ä¸ºbåŒºåŸŸåŒ…æ‹¬äº†aåŒºåŸŸ,æŒ‰ç­‰é«˜çº¿ç†è§£,a>b
                return  1;
            }
            else if (a[1] > b[2] || a[2] < b[1]
                    || a[3] > b[4] || a[4] < b[3]
            ) {
                //ä¸ç›¸äº¤,ç›¸ç­‰
                return 0;
            }else{
                //æ­¤ä¸ºç›¸äº¤çš„æ—¶å€™,çœ‹å“ªä¸ªåœ¨ä¸Šé¢å°±çœ‹ç›¸äº¤çš„é‚£ä¸ªè§’æ˜¯ä¸æ˜¯aé¢œè‰²,æ˜¯åˆ™è®¤ä¸ºaåœ¨ä¸Š
                // 1 1 1 0
                // 1 2 2 2
                // 1 2 2 2
                for (int i = 1; i <= 2; i++) { //çºµåæ ‡å·¦å³ x
                    for (int j = 3; j <= 4; j++) { //æ¨ªåæ ‡çš„ä¸Šä¸‹é™ y
                        if (b[i] >= a[1] && b[i] <= a[2]
                                && b[j] >= a[3] && b[j] <= a[4]
                        ){
                            //è¡¨ç¤ºæ‰¾åˆ°äº†è¿™ä¸ªåœ¨aåŒºåŸŸç›¸äº¤çš„bçš„è§’,å¦‚æœè¿™ä¸ªä½ç½®ä¸ç­‰äºå®ƒæœ¬èº«çš„é¢œè‰²,æˆ‘ä»¬å°±è®¤ä¸ºbè¢«aç›–ä½,å³a>b
                            return b[0] != targetGrid[b[j]][b[i]] ? 1:-1;
                        }
                    }
                }
                return 1;
            }
        });
        //è¿™ä¸ªæ—¶å€™é¢œè‰²åŒºåŸŸå·²ç»æ’å¥½åºäº†,æŒ‰è¿™ä¸ªåºå·å¡«å……
        int[][] newquyu = new int[targetGrid.length][targetGrid[0].length];
        for (int[] ints : yanselist) {
            int yanse = ints[0];
            int minx = ints[1];
            int maxx = ints[2];
            int miny = ints[3];
            int maxy = ints[4];
            for (int xx = minx; xx <= maxx; xx++) {
                for (int yy = miny; yy <= maxy; yy++) {
                    newquyu[yy][xx]=yanse;
                }
            }
        }
        //å†æ¯”å¯¹
        for (int xx = 0; xx < targetGrid[0].length; xx++) {
            for (int yy = 0; yy < targetGrid.length; yy++) {
                if (targetGrid[yy][xx] != newquyu[yy][xx]){
                    return false;
                }
            }
        }
        return true;
    }

}